---
title: "Project One"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## MT5763 Software and Data Analysis **Due: 8th October**

Please find my GitHub repo here <https://github.com/selsiekiely/MT5763_1_190018562>.

### **Contents**
### Data Wrangling
###Data Visualisation
###Statistical Modelling

##**Data Wrangling**
## We will now data wrangle the BikeSeoul.csv

```{r, include = FALSE}
library(tidyverse)
library(readr)
BikeSeoul <- read_csv("~/Year 3/MT5763/BikeSeoul.csv")
View(BikeSeoul)
BikeWashington <- read_csv("~/Year 3/MT5763/BikeWashingtonDC.csv")
```

```{r BikeSeoul}
BikeSeoul <- BikeSeoul %>%
  select(- `Visibility (10m)`, -`Dew point temperature(C)`, -`Solar Radiation (MJ/m2)`, 
         -`Rainfall(mm)`, -`Snowfall (cm)`)
BikeSeoul <- BikeSeoul %>%  
  filter(!is.na(`Rented Bike Count`))
BikeSeoul <- BikeSeoul %>% 
  select(-`Functioning Day`)
library(lubridate)
BikeSeoul <- BikeSeoul %>%
  rename(Count = `Rented Bike Count`) %>%
  rename(Temperature = `Temperature(C)`) %>%
  rename(Humidity = `Humidity(%)`) %>%
  rename(WindSpeed = `Wind speed (m/s)`) %>%
  rename(Season = `Seasons`) %>%
  mutate(Date = as.Date(Date, format = "%d/%m/%Y"))
year(BikeSeoul$Date) <- year(BikeSeoul$Date) + 2000
BikeSeoul <- BikeSeoul %>%
  mutate(BikeSeoul, FullDate = make_datetime(year = year(Date), month = month(Date), day = mday(Date), Hour)) %>%
  mutate(Temperature = as.numeric(Temperature))
BikeSeoul$Holiday <- ifelse(BikeSeoul$Holiday == "No Holiday", "No", "Yes")
yes_no_levels <- c("Yes", "No")
season_levels <- c("Spring", "Summer", "Autumn", "Winter")
BikeSeoul <- BikeSeoul %>%
  mutate(Holiday = factor(Holiday, levels = yes_no_levels),
         Season = factor(Season, levels = season_levels)) %>%
   arrange(Season, Holiday)# %>%
#order(Season, method = season_levels)
View(BikeSeoul)

```
```{r BikeWashington}
BikeWashington <- BikeWashington %>%
  select(-instant, -yr, -mnth, -weekday, -workingday, -weathersit, -atemp, -casual, -registered)
BikeWashington <- BikeWashington %>%
  rename(Date = dteday) %>%
  rename(Count = cnt) %>%
  rename(Hour = hr) %>%
  rename(Temperature = temp) %>%
  rename(Humidity = hum) %>%
  rename(WindSpeed = windspeed) %>%
  rename(Season = season) %>%
  rename(Holiday = holiday)
BikeWashington$Humidity <- paste(100*BikeWashington$Humidity)#
BikeWashington$Temperature <- paste(47*BikeWashington$Temperature - 8)
BikeWashington$WindSpeed <- paste(67*(18/5)*BikeWashington$WindSpeed)
season_levels <- c("Spring", "Summer", "Autumn", "Winter")
yes_no_levels <- c("Yes", "No")
#BikeWashington <- BikeWashington %>%
 # order(Season, method = season_levels) %>%
  #factor(Holiday, levels = yes_no_levels)
BikeWashington$Date <- as.Date(BikeWashington$Date)
BikeWashington <- BikeWashington %>%
  mutate(BikeWashington, FullDate = make_datetime(year = year(Date), month = month(Date), day = mday(Date), Hour)) %>% 
  mutate(Temperature = as.numeric(Temperature))
View(BikeWashington)
```
# **Data Visualisation**
## How does air temperature vary over the course of a year?
### Conjoin the two data sets in order to use ggplot.
```{r, include= FALSE}
library(dplyr)
library(ggplot2)
BikeSeoul %>% count(year(Date), Temperature) %>% summary()
BikeWashington %>% count(year(Date), Temperature) %>% summary()
First_graph_data <- full_join(BikeSeoul, BikeWashington, by = c("Date", "Temperature"))
ggplot(First_graph_data) +
  geom_point(aes(x = year(Date), y = Temperature))
```



Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
